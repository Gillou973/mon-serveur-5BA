<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commande - Ma Boutique</title>

    <!-- Styles -->
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/toast.css">
    <link rel="stylesheet" href="/css/checkout.css">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="/index.html" class="logo">Ma Boutique</a>
            <nav>
                <a href="/index.html">Accueil</a>
                <a href="/products.html">Produits</a>
                <a href="/cart.html">
                    Panier
                    <span class="cart-badge" id="cartCount">0</span>
                </a>
                <a href="/account.html">Mon Compte</a>
            </nav>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-wrapper">
            <div class="progress-steps">
                <div class="progress-line" id="progressLine"></div>
                <div class="progress-step active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Livraison</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Expédition</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Paiement</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="step-circle">4</div>
                    <div class="step-label">Confirmation</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container">
        <div class="checkout-layout">
            <!-- Steps Content -->
            <div class="steps-content">
                <!-- Step 1: Shipping Address -->
                <div class="step-content active" data-step="1">
                    <h2 class="step-title">Adresse de livraison</h2>
                    <form id="shippingForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">Prénom</label>
                                <input type="text" class="form-input" name="firstName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Nom</label>
                                <input type="text" class="form-input" name="lastName" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label required">Adresse</label>
                            <input type="text" class="form-input" name="address" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Complément d'adresse</label>
                            <input type="text" class="form-input" name="addressComplement">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">Code postal</label>
                                <input type="text" class="form-input" name="zipCode" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label required">Ville</label>
                                <input type="text" class="form-input" name="city" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label required">Pays</label>
                            <input type="text" class="form-input" name="country" value="France" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label required">Téléphone</label>
                            <input type="tel" class="form-input" name="phone" required>
                        </div>

                        <div class="step-actions">
                            <a href="/cart.html" class="btn btn-secondary">Retour au panier</a>
                            <button type="button" class="btn btn-primary" onclick="nextStep()">
                                Continuer
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Step 2: Shipping Method -->
                <div class="step-content" data-step="2">
                    <h2 class="step-title">Méthode de livraison</h2>

                    <div class="shipping-methods" id="shippingMethods">
                        <!-- Populated by JS -->
                    </div>

                    <div class="step-actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">
                            Retour
                        </button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()" id="shippingNextBtn" disabled>
                            Continuer
                        </button>
                    </div>
                </div>

                <!-- Step 3: Payment Method -->
                <div class="step-content" data-step="3">
                    <h2 class="step-title">Méthode de paiement</h2>

                    <div class="payment-methods" id="paymentMethods">
                        <!-- Populated by JS -->
                    </div>

                    <!-- Card Details Form -->
                    <div class="card-details" id="cardDetails">
                        <div class="form-group">
                            <label class="form-label required">Numéro de carte</label>
                            <input type="text" class="form-input" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">Date d'expiration</label>
                                <input type="text" class="form-input" id="cardExpiry" placeholder="MM/AA" maxlength="5">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">CVV</label>
                                <input type="text" class="form-input" id="cardCvv" placeholder="123" maxlength="3">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label required">Nom sur la carte</label>
                            <input type="text" class="form-input" id="cardName">
                        </div>
                    </div>

                    <div class="step-actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">
                            Retour
                        </button>
                        <button type="button" class="btn btn-primary" onclick="nextStep()" id="paymentNextBtn" disabled>
                            Continuer
                        </button>
                    </div>
                </div>

                <!-- Step 4: Confirmation -->
                <div class="step-content" data-step="4">
                    <h2 class="step-title">Récapitulatif de la commande</h2>

                    <div id="recapContainer">
                        <!-- Populated by JS -->
                    </div>

                    <!-- Terms -->
                    <div class="form-group">
                        <label style="display: flex; align-items: center; cursor: pointer;">
                            <input type="checkbox" id="acceptTerms" style="margin-right: 0.5rem;">
                            J'accepte les conditions générales de vente
                        </label>
                    </div>

                    <div class="step-actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep()">
                            Retour
                        </button>
                        <button type="button" class="btn btn-primary" onclick="placeOrder()" id="placeOrderBtn" disabled>
                            Valider la commande
                        </button>
                    </div>
                </div>

                <!-- Order Placed -->
                <div class="step-content" data-step="5">
                    <div class="confirmation-icon">✅</div>
                    <div class="confirmation-message">
                        <h2>Commande confirmée !</h2>
                        <p>Merci pour votre commande.</p>
                        <p>Votre numéro de commande est : <span class="order-number" id="orderNumber"></span></p>
                        <p>Vous recevrez un email de confirmation sous peu.</p>
                    </div>

                    <div class="step-actions">
                        <a href="/index.html" class="btn btn-secondary">
                            Retour à l'accueil
                        </a>
                        <a href="/orders.html" class="btn btn-primary">
                            Voir mes commandes
                        </a>
                    </div>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="order-summary">
                <h2 class="summary-title">Récapitulatif</h2>

                <!-- Cart Items -->
                <div class="summary-section">
                    <div class="summary-section-title">Vos articles</div>
                    <div class="summary-items" id="summaryItems"></div>
                </div>

                <!-- Totals -->
                <div class="summary-section">
                    <div class="summary-row">
                        <span class="summary-label">Sous-total</span>
                        <span class="summary-value" id="summarySubtotal">0,00 €</span>
                    </div>

                    <div class="summary-row">
                        <span class="summary-label">Livraison</span>
                        <span class="summary-value" id="summaryShipping">À calculer</span>
                    </div>
                </div>

                <!-- Total -->
                <div class="summary-section summary-total">
                    <div class="summary-row">
                        <span class="summary-label">Total</span>
                        <span class="summary-value" id="summaryTotal">0,00 €</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="/js/config.js"></script>
    <script src="/js/toast.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/api.js"></script>
    <script src="/js/checkout-page.js"></script>
</body>
</html>
